<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Catatan Pintar Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6200ee;
            --bg-light: #ffffff;
            --danger: #b00020;
            --text-dark: #000000;
            --text-gray: #757575;
            --border-color: #eeeeee;
        }

        /* PERBAIKAN: Mematikan efek loading/overscroll saat diusap */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            overscroll-behavior-y: contain; /* Mencegah pull-to-refresh */
            background-color: var(--bg-light);
            color: var(--text-dark);
            -webkit-tap-highlight-color: transparent;
            font-family: 'Segoe UI', Roboto, sans-serif;
        }
        
        .app-bar {
            background: #3f51b5;
            color: white;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .screen { display: none; height: 100vh; flex-direction: column; }
        .screen.active { display: flex; }

        /* PERBAIKAN: Font pencarian lebih besar */
        .search-container {
            padding: 12px 15px;
            background: #f1f3f4;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid #ddd;
        }

        .search-container input {
            flex: 1;
            border: none;
            background: transparent;
            outline: none;
            font-size: 18px; /* Ukuran font ditingkatkan */
        }

        .content-area { 
            flex: 1; 
            overflow-y: auto; 
            padding: 10px 0; 
            padding-bottom: 100px;
            -webkit-overflow-scrolling: touch;
        }
        
        .note-card {
            padding: 18px 20px;
            border-bottom: 1px solid var(--border-color);
        }

        /* PERBAIKAN: Font judul & isi lebih besar */
        .note-card h3 { font-size: 20px; margin-bottom: 6px; font-weight: bold; }
        .note-card p { color: var(--text-gray); font-size: 17px; }
        .note-date { font-size: 13px; color: #999; margin-top: 8px; display: block; }

        .editor-nav {
            padding: 15px;
            display: flex;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }

        .editor-nav h2 { flex: 1; text-align: center; font-size: 20px; margin-right: 30px; font-weight: bold; }

        .input-group { padding: 25px; flex: 1; display: flex; flex-direction: column; }
        
        /* PERBAIKAN: Input editor lebih besar */
        .input-title {
            font-size: 26px; font-weight: bold; border: none; outline: none;
            margin-bottom: 15px; width: 100%; color: var(--text-dark);
        }
        .input-body {
            flex: 1; border: none; outline: none; font-size: 20px; resize: none; line-height: 1.6;
        }

        .footer-actions {
            display: flex; gap: 15px; padding: 20px; background: white; border-top: 1px solid #eee;
        }

        .btn {
            flex: 1; padding: 16px; border-radius: 6px; font-weight: bold;
            font-size: 17px; cursor: pointer; border: none; text-align: center;
        }

        .btn-outline { border: 2.2px solid var(--danger); background: white; color: var(--danger); }
        .btn-filled { background: var(--primary); color: white; }

        .fab {
            position: fixed; right: 25px; bottom: 25px;
            width: 65px; height: 65px; border-radius: 50%;
            background: #6200ee; color: white;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); border: none; font-size: 28px;
        }

        .hidden-input { display: none; }
    </style>
</head>
<body>

    <div id="screen-list" class="screen active">
        <div class="app-bar">
            <i class="fas fa-bars"></i>
            <span>tokoquapp</span>
            <i class="fas fa-ellipsis-v" onclick="toggleBackup()"></i>
        </div>

        <div id="backup-menu" style="display: none; background: #fff; padding: 10px; border-bottom: 1px solid #ddd; text-align: center;">
            <button onclick="exportData()" style="padding: 8px 12px; margin-right: 5px;">Backup</button>
            <button onclick="document.getElementById('importFile').click()" style="padding: 8px 12px;">Restore</button>
            <input type="file" id="importFile" class="hidden-input" accept=".json" onchange="importData(event)">
        </div>

        <div class="search-container">
            <i class="fas fa-search"></i>
            <input type="text" id="search-input" placeholder="Cari catatan..." oninput="handleSearch()">
        </div>

        <div class="content-area" id="notes-list"></div>
        <button class="fab" onclick="openEditor()"><i class="fas fa-plus"></i></button>
    </div>

    <div id="screen-editor" class="screen">
        <div class="editor-nav">
            <i class="fas fa-arrow-left" onclick="closeEditor()"></i>
            <h2 id="editor-title">Edit Catatan</h2>
        </div>
        <div class="input-group">
            <input type="text" id="note-title" class="input-title" placeholder="Judul">
            <hr style="border: 0; border-top: 1px solid #eee; margin-bottom: 20px;">
            <textarea id="note-content" class="input-body" placeholder="Tulis catatan..."></textarea>
        </div>
        <div class="footer-actions">
            <button class="btn btn-outline" id="btn-delete" onclick="deleteNote()">HAPUS</button>
            <button class="btn btn-filled" onclick="saveNote()">SIMPAN</button>
        </div>
    </div>

    <script>
        let notes = JSON.parse(localStorage.getItem('notes_db_kodular')) || [];
        let currentId = null;

        function renderNotes(dataToRender = null) {
            const list = document.getElementById('notes-list');
            list.innerHTML = '';
            const data = dataToRender || notes;
            data.sort((a, b) => b.id - a.id);

            if (data.length === 0) {
                list.innerHTML = '<p style="text-align:center; color:#ccc; margin-top:50px; font-size:18px;">Belum ada catatan</p>';
                return;
            }

            data.forEach(note => {
                const div = document.createElement('div');
                div.className = 'note-card';
                div.onclick = () => openEditor(note);
                div.innerHTML = `<h3>${note.title}</h3><p>${note.content.substring(0, 60)}</p><span class="note-date"><i class="far fa-calendar"></i> ${note.date}</span>`;
                list.appendChild(div);
            });
        }

        function handleSearch() {
            const keyword = document.getElementById('search-input').value.toLowerCase();
            const filtered = notes.filter(n => n.title.toLowerCase().includes(keyword) || n.content.toLowerCase().includes(keyword));
            renderNotes(filtered);
        }

        function openEditor(note = null) {
            if (note) {
                currentId = note.id;
                document.getElementById('note-title').value = note.title;
                document.getElementById('note-content').value = note.content;
                document.getElementById('btn-delete').style.visibility = 'visible';
            } else {
                currentId = null;
                document.getElementById('note-title').value = '';
                document.getElementById('note-content').value = '';
                document.getElementById('btn-delete').style.visibility = 'hidden';
            }
            document.getElementById('screen-list').classList.remove('active');
            document.getElementById('screen-editor').classList.add('active');
        }

        function closeEditor() {
            document.getElementById('screen-editor').classList.remove('active');
            document.getElementById('screen-list').classList.add('active');
            renderNotes();
        }

        function saveNote() {
            const title = document.getElementById('note-title').value.trim() || "Tanpa Judul";
            const content = document.getElementById('note-content').value.trim();
            const now = new Date();
            const dateStr = now.toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' });

            if (currentId) {
                notes = notes.map(n => n.id === currentId ? {...n, title, content, date: dateStr} : n);
            } else {
                notes.unshift({ id: Date.now(), title, content, date: dateStr });
            }
            localStorage.setItem('notes_db_kodular', JSON.stringify(notes));
            closeEditor();
        }

        function deleteNote() {
            if (confirm("Hapus catatan ini?")) {
                notes = notes.filter(n => n.id !== currentId);
                localStorage.setItem('notes_db_kodular', JSON.stringify(notes));
                closeEditor();
            }
        }

        function toggleBackup() {
            const menu = document.getElementById('backup-menu');
            menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
        }

        function exportData() {
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(JSON.stringify(notes));
            const link = document.createElement('a');
            link.setAttribute('href', dataUri);
            link.setAttribute('download', 'backup.json');
            link.click();
        }

        function importData(event) {
            const reader = new FileReader();
            reader.onload = function(e) {
                notes = JSON.parse(e.target.result);
                localStorage.setItem('notes_db_kodular', JSON.stringify(notes));
                renderNotes();
            };
            reader.readAsText(event.target.files[0]);
        }

        renderNotes();
    </script>
</body>
</html>